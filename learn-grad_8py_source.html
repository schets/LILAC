<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LILAC: python/learn-grad.py Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">LILAC
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">python/learn-grad.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="learn-grad_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespacelearn-grad.html">00001</a> <span class="keyword">import</span> numpy <span class="keyword">as</span> np
<a name="l00002"></a>00002 <span class="keyword">from</span> sklearn <span class="keyword">import</span> manifold, svm, preprocessing
<a name="l00003"></a>00003 <span class="keyword">import</span> pylab <span class="keyword">as</span> pl
<a name="l00004"></a>00004 <span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D
<a name="l00005"></a>00005 <span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> NullFormatter
<a name="l00006"></a>00006 Axes3D
<a name="l00007"></a><a class="code" href="namespacelearn-grad.html#af6f66e66af67fde0dfd86dbbb68c333c">00007</a> <span class="keyword">def </span><a class="code" href="namespacelearn-grad.html#af6f66e66af67fde0dfd86dbbb68c333c">read_data</a>(gradname, scorename):
<a name="l00008"></a>00008     <span class="comment">#could use numpy.loadtxt, but that blindly accepts nan values</span>
<a name="l00009"></a>00009     slist = open(scorename, <span class="stringliteral">&#39;</span><span class="stringliteral">r&#39;).readlines()</span>
<a name="l00010"></a>00010 <span class="stringliteral">    glist =  open(gradname, </span><span class="stringliteral">&#39;</span><span class="stringliteral">r&#39;).readlines()</span>
<a name="l00011"></a>00011 <span class="stringliteral">    v = (slist, glist)</span>
<a name="l00012"></a>00012 <span class="stringliteral">    gkeep = []</span>
<a name="l00013"></a>00013 <span class="stringliteral">    skeep = []</span>
<a name="l00014"></a>00014 <span class="stringliteral">    </span><span class="keywordflow">for</span> s, g <span class="keywordflow">in</span> zip(slist, glist):
<a name="l00015"></a>00015         sval = float(s.split()[0])
<a name="l00016"></a>00016         if(np.isfinite(sval)):
<a name="l00017"></a>00017             skeep.append(np.fromstring(s, sep=<span class="stringliteral">&#39; &#39;</span>))
<a name="l00018"></a>00018             nar = np.fromstring(g, sep=<span class="stringliteral">&#39; &#39;</span>)
<a name="l00019"></a>00019             gkeep.append(nar)
<a name="l00020"></a>00020     <span class="keywordflow">return</span> (np.vstack(skeep), np.vstack(gkeep))
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 (scores, grads) = <a class="code" href="namespacelearn-grad.html#af6f66e66af67fde0dfd86dbbb68c333c">read_data</a>(<span class="stringliteral">&quot;grad_data.out&quot;</span>, <span class="stringliteral">&quot;score_data.out&quot;</span>)
<a name="l00024"></a>00024 (scores2, grads2) = <a class="code" href="namespacelearn-grad.html#af6f66e66af67fde0dfd86dbbb68c333c">read_data</a>(<span class="stringliteral">&quot;grad_data2.out&quot;</span>, <span class="stringliteral">&quot;score_data2.out&quot;</span>)
<a name="l00025"></a>00025 n_neighbors=50
<a name="l00026"></a>00026 n_components=15
<a name="l00027"></a><a class="code" href="namespacelearn-grad.html#aadcc195c5be666a238297843fdccac69">00027</a> scaler =preprocessing.StandardScaler().fit(grads);
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="namespacelearn-grad.html#a2b4241131e1f17cd2c788981d2620119">00029</a> grads = scaler.transform(grads)
<a name="l00030"></a><a class="code" href="namespacelearn-grad.html#aeae0222a15a4261c5ccb0b2880f87298">00030</a> grads2 = scaler.transform(grads2)
<a name="l00031"></a>00031 <span class="comment">#Y = manifold.Isomap(n_neighbors, n_components).fit_transform(grads)</span>
<a name="l00032"></a><a class="code" href="namespacelearn-grad.html#a6e5d9b210387eca43babb9ddf00c0fe7">00032</a> Y=grads <span class="comment">#don&#39;t perform dimensionality reduction</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="comment">#perform classification on the dataset, use support vector machine</span>
<a name="l00035"></a><a class="code" href="namespacelearn-grad.html#ad1717b9fb5aca44b5a4ea79fe927ad6c">00035</a> test_svm = svm.SVC(kernel=<span class="stringliteral">&#39;rbf&#39;</span>, C=20, gamma=0.15, probability=<span class="keyword">True</span>)
<a name="l00036"></a>00036 test_svm=test_svm.fit(Y, scores[:, 1])
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">#get number of stable classified as unstable</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 pl.figure(0)
<a name="l00041"></a>00041 (Y, scores) = grads2, scores2
<a name="l00042"></a><a class="code" href="namespacelearn-grad.html#afacac49a6273026cb171d0678dd79c31">00042</a> num_stab = sum(1 <span class="keywordflow">for</span> s <span class="keywordflow">in</span> scores <span class="keywordflow">if</span> s[1] == 1)
<a name="l00043"></a><a class="code" href="namespacelearn-grad.html#a5a2ea12050ad62acf22b66ed0a973b57">00043</a> missed_stab_arr = [s[0] <span class="keywordflow">for</span> t, s, <span class="keywordflow">in</span> zip(Y, scores) <span class="keywordflow">if</span> s[1]==1 <span class="keywordflow">and</span> test_svm.predict(t) != s[1]]
<a name="l00044"></a>00044 pl.hist(missed_stab_arr, bins=20)
<a name="l00045"></a>00045 pl.title(<span class="stringliteral">&quot;Frequency of scores for the misclassified stable solutions&quot;</span>)
<a name="l00046"></a>00046 pl.xlabel(<span class="stringliteral">&quot;score&quot;</span>)
<a name="l00047"></a><a class="code" href="namespacelearn-grad.html#a54f62ec3c0f96993c3f365d7209b4973">00047</a> missed_stab = len(missed_stab_arr)
<a name="l00048"></a><a class="code" href="namespacelearn-grad.html#a1c463ead40bb974028b5692a231f3cf5">00048</a> ave_score = sum(missed_stab_arr)/len(missed_stab_arr);
<a name="l00049"></a><a class="code" href="namespacelearn-grad.html#a60ebd19db8c7a7e2b17e6358c51e0127">00049</a> max_score = <a class="code" href="lsoda_8cpp.html#affe776513b24d84b39af8ab0930fef7f">max</a>(missed_stab_arr)
<a name="l00050"></a>00050 missed_stab_arr = [s[0] <span class="keywordflow">for</span> t, s, <span class="keywordflow">in</span> zip(Y, scores) <span class="keywordflow">if</span> s[1]==1 <span class="keywordflow">and</span> test_svm.predict(t) == s[1]]
<a name="l00051"></a>00051 pl.figure(1)
<a name="l00052"></a>00052 pl.hist(missed_stab_arr, bins=50, color=<span class="stringliteral">&#39;green&#39;</span>)
<a name="l00053"></a>00053 pl.title(<span class="stringliteral">&quot;Frequency of scores for the correctly classified stable solutions&quot;</span>)
<a name="l00054"></a>00054 pl.xlabel(<span class="stringliteral">&quot;score&quot;</span>)
<a name="l00055"></a><a class="code" href="namespacelearn-grad.html#ab592d9413e62fc6b125ea69927401e18">00055</a> ave_good_score = sum(missed_stab_arr)/len(missed_stab_arr);
<a name="l00056"></a><a class="code" href="namespacelearn-grad.html#a2d3ec26a28f7c16fca7b7c84e9b6b362">00056</a> max_good_score = <a class="code" href="lsoda_8cpp.html#affe776513b24d84b39af8ab0930fef7f">max</a>(missed_stab_arr)
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="keywordflow">print</span> <span class="stringliteral">&quot;%d out of %d stable solutions were missclassified&quot;</span> %(missed_stab, num_stab)
<a name="l00059"></a>00059 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Average score of the missclassified stable variables is %f, maximum score is %f&quot;</span> % (ave_score, max_score)
<a name="l00060"></a>00060 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Average score of the classified stable variables is %f, maximum score is %f&quot;</span> % (ave_good_score, max_good_score)
<a name="l00061"></a>00061 <span class="comment">#calculate average probability of misclassified stable variantsdd</span>
<a name="l00062"></a>00062 <span class="comment">#calculate number of missed unstable variants</span>
<a name="l00063"></a><a class="code" href="namespacelearn-grad.html#a325b7741a37c7ca7fdf77ab3b749b7dd">00063</a> num_unstab = sum(1 <span class="keywordflow">for</span> s <span class="keywordflow">in</span> scores <span class="keywordflow">if</span> s[1] == 0)
<a name="l00064"></a><a class="code" href="namespacelearn-grad.html#a048365b5e86a001f8ef6a08ba6d63de1">00064</a> missed_unstab = sum(1 <span class="keywordflow">for</span> t, s <span class="keywordflow">in</span> zip(Y, scores) <span class="keywordflow">if</span> s[1] == 0 <span class="keywordflow">and</span> test_svm.predict(t) != s[1])
<a name="l00065"></a>00065 <span class="keywordflow">print</span> <span class="stringliteral">&quot;%d out of %d unstable solutions were missclassified&quot;</span> %(missed_unstab, num_unstab)
<a name="l00066"></a>00066 pl.legend()
<a name="l00067"></a>00067 pl.show()
<a name="l00068"></a>00068 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00069"></a>00069 <span class="stringliteral">fig = pl.figure(figsize=(15, 8))</span>
<a name="l00070"></a>00070 <span class="stringliteral">pl.suptitle(&quot;Manifold Learning with %i points, %i neighbors&quot;</span>
<a name="l00071"></a>00071 <span class="stringliteral">            % (grads.shape[1], n_neighbors), fontsize=14)</span>
<a name="l00072"></a>00072 <span class="stringliteral"></span>
<a name="l00073"></a>00073 <span class="stringliteral">#perform clustering</span>
<a name="l00074"></a>00074 <span class="stringliteral"># compatibility matplotlib &lt; 1.0</span>
<a name="l00075"></a>00075 <span class="stringliteral">ax = fig.add_subplot(241, projection=&#39;3d&#39;)</span>
<a name="l00076"></a>00076 <span class="stringliteral">ax.scatter(Y[:, 0], Y[:, 1], Y[:, 2], c=scores[:, 0], cmap=pl.cm.Spectral)</span>
<a name="l00077"></a>00077 <span class="stringliteral">ax.view_init(4, -72)</span>
<a name="l00078"></a>00078 <span class="stringliteral">pl.show()</span>
<a name="l00079"></a>00079 <span class="stringliteral">#pl.scatter(Y[:, 0], Y[:, 1], Y[:, 2], c=scores, cmap=pl.cm.Spectral)</span>
<a name="l00080"></a>00080 <span class="stringliteral">&quot;&quot;&quot;</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Mar 29 2014 23:44:02 for LILAC by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
